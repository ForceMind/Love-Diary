<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿ƒåŠ¨æ—¥è®°ï½œLove Diary</title>
    <link rel="icon" type="image/svg+xml" href="assets/images/favicon.svg">
    <link rel="stylesheet" href="assets/css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- çˆ±å¿ƒèƒŒæ™¯æ•ˆæœ -->
    <div class="hearts-background">
        <div class="heart">â™¥</div>
        <div class="heart">â™¥</div>
        <div class="heart">â™¥</div>
        <div class="heart">â™¥</div>
        <div class="heart">â™¥</div>
        <div class="heart">â™¥</div>
        <div class="heart">â™¥</div>
        <div class="heart">â™¥</div>
        <div class="heart">â™¥</div>
        <div class="heart">â™¥</div>
    </div>

    <!-- ä¸»é¡µé¢å®¹å™¨ -->
    <div class="main-container">
        <!-- ä¸»èœå•ç•Œé¢ -->
        <div id="main-menu" class="screen active">
            <div class="title-container">
                <h1 class="game-title">å¿ƒåŠ¨æ—¥è®°</h1>
                <h2 class="game-subtitle">Love Diary</h2>
            </div>
            <div class="menu-buttons">
                <button id="new-game-btn">å¼€å§‹æ¸¸æˆ</button>
                <button id="continue-game-btn">ç»§ç»­æ¸¸æˆ</button>
                <button id="achievements-btn">æˆå°±ç³»ç»Ÿ</button>
                <button id="gallery-btn">å›å¿†ç›¸å†Œ</button>
                <button id="settings-btn">è®¾ç½®</button>
                <!-- å¿«é€Ÿæµ‹è¯•æŒ‰é’®å·²éšè—ï¼Œå¦‚éœ€æµ‹è¯•è¯·ä½¿ç”¨ test.html -->
            </div>
        </div>
        
        <!-- æ¸¸æˆä¸»ç•Œé¢ -->
        <div id="game-screen" class="screen">
            <!-- æ‰‹æœºç«¯é¡¶éƒ¨çŠ¶æ€æ  -->
            <div class="mobile-top-bar">
                <div class="mobile-stats-item">
                    <span>ğŸ“…</span>
                    <span>ç¬¬<span id="mobile-current-week">1</span>å‘¨</span>
                </div>
                <div class="mobile-stats-item">
                    <span>âš¡</span>
                    <span><span id="mobile-current-actions">2</span>ç‚¹è¡ŒåŠ¨åŠ›</span>
                </div>
                <div class="mobile-stats-item">
                    <span>ğŸ“š</span>
                    <span>å­¦ä¹ <span id="mobile-study-count">0</span></span>
                </div>
                <div class="mobile-stats-item">
                    <span>ğŸ’¬</span>
                    <span>ç¤¾äº¤<span id="mobile-social-count">0</span></span>
                </div>
                <div class="mobile-stats-item">
                    <span>ğŸµ</span>
                    <span>ä¼‘é—²<span id="mobile-leisure-count">0</span></span>
                </div>
                <div class="mobile-stats-item" id="mobile-top-character">
                    <span>ğŸ’•</span>
                    <span>å¥½æ„Ÿåº¦</span>
                </div>
            </div>
            
            <!-- æ‰‹æœºç«¯è®¾ç½®æŒ‰é’® -->
            <button class="mobile-settings-btn" id="mobile-settings-btn">
                âš™ï¸
            </button>
            
            <div class="game-header">
                <div class="game-title-bar">
                    <h2>å¿ƒåŠ¨æ—¥è®° - æ¸¸æˆè¿›è¡Œä¸­</h2>
                </div>
                
                <!-- ç©å®¶ä¿¡æ¯æ  -->
                <div class="player-info-bar">
                    <div class="player-info-left">
                        <div id="player-info">è§’è‰²ä¿¡æ¯</div>
                    </div>
                    <div class="player-info-right">
                        <div class="game-stats">
                            <span id="current-week">ç¬¬1å‘¨</span>
                            <span>è¡ŒåŠ¨ç‚¹æ•°: <span id="current-actions">2/2</span></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="game-content">
                <!-- æ—¥å†ç³»ç»Ÿ -->
                <div class="calendar-container">
                    <h3 style="text-align: center; color: #ff6b9d; margin-bottom: 20px;">ğŸ“… é€‰æ‹©ä¸€å¤©è¿›è¡Œæ´»åŠ¨</h3>
                    <div class="calendar-grid">
                        <div class="day-slot" id="day-1" style="cursor: pointer;" title="ç‚¹å‡»è¿›è¡Œæ˜ŸæœŸä¸€æ´»åŠ¨">
                            <div class="day-name">æ˜ŸæœŸä¸€</div>
                            <div class="day-icon">ğŸ“š</div>
                            <div class="day-activity">å­¦ä¹ </div>
                        </div>
                        <div class="day-slot" id="day-2" style="cursor: pointer;" title="ç‚¹å‡»è¿›è¡Œæ˜ŸæœŸäºŒæ´»åŠ¨">
                            <div class="day-name">æ˜ŸæœŸäºŒ</div>
                            <div class="day-icon">ğŸ¨</div>
                            <div class="day-activity">ç¤¾äº¤</div>
                        </div>
                        <div class="day-slot" id="day-3" style="cursor: pointer;" title="ç‚¹å‡»è¿›è¡Œæ˜ŸæœŸä¸‰æ´»åŠ¨">
                            <div class="day-name">æ˜ŸæœŸä¸‰</div>
                            <div class="day-icon">ğŸµ</div>
                            <div class="day-activity">ä¼‘é—²</div>
                        </div>
                        <div class="day-slot" id="day-4" style="cursor: pointer;" title="ç‚¹å‡»è¿›è¡Œæ˜ŸæœŸå››æ´»åŠ¨">
                            <div class="day-name">æ˜ŸæœŸå››</div>
                            <div class="day-icon">âš½</div>
                            <div class="day-activity">ç¤¾äº¤</div>
                        </div>
                        <div class="day-slot" id="day-5" style="cursor: pointer;" title="ç‚¹å‡»è¿›è¡Œæ˜ŸæœŸäº”æ´»åŠ¨">
                            <div class="day-name">æ˜ŸæœŸäº”</div>
                            <div class="day-icon">ğŸ“–</div>
                            <div class="day-activity">å­¦ä¹ </div>
                        </div>
                        <div class="day-slot" id="day-6" style="cursor: pointer;" title="ç‚¹å‡»è¿›è¡Œæ˜ŸæœŸå…­æ´»åŠ¨">
                            <div class="day-name">æ˜ŸæœŸå…­</div>
                            <div class="day-icon">ğŸŒ¸</div>
                            <div class="day-activity">ä¼‘é—²</div>
                        </div>
                        <div class="day-slot" id="day-7" style="cursor: pointer;" title="ç‚¹å‡»è¿›è¡Œæ˜ŸæœŸæ—¥æ´»åŠ¨">
                            <div class="day-name">æ˜ŸæœŸæ—¥</div>
                            <div class="day-icon">â˜•</div>
                            <div class="day-activity">å¶é‡</div>
                        </div>
                    </div>
                </div>
                
                <!-- æ¸¸æˆçŠ¶æ€ä¿¡æ¯ -->
                <div class="game-status">
                    <div class="status-card">
                        <h4>ğŸ“Š æœ¬å‘¨ç»Ÿè®¡</h4>
                        <div id="week-stats">
                            <div>å­¦ä¹ æ¬¡æ•°: <span id="study-count">0</span></div>
                            <div>ç¤¾äº¤æ¬¡æ•°: <span id="social-count">0</span></div>
                            <div>ä¼‘é—²æ¬¡æ•°: <span id="leisure-count">0</span></div>
                            <div>å¶é‡æ¬¡æ•°: <span id="encounter-count">0</span></div>
                        </div>
                    </div>
                    
                    <div class="status-card">
                        <h4>ğŸ’• è§’è‰²å¥½æ„Ÿåº¦</h4>
                        <div id="affection-stats">
                            <!-- åŠ¨æ€ç”Ÿæˆå¥½æ„Ÿåº¦ä¿¡æ¯ -->
                        </div>
                    </div>
                </div>
                
                <!-- æ¸¸æˆæ§åˆ¶æŒ‰é’® -->
                <div class="game-controls">
                    <button id="save-game-btn" class="btn-save">ğŸ’¾ ä¿å­˜æ¸¸æˆ</button>
                    <button id="settings-btn" class="btn-settings">âš™ï¸ æ¸¸æˆè®¾ç½®</button>
                    <button id="back-to-menu-btn" class="btn-menu">ğŸ  è¿”å›ä¸»èœå•</button>
                    <button id="next-week-btn" class="btn-next" style="display: none;">â­ï¸ ä¸‹ä¸€å‘¨</button>
                </div>
            </div>
        </div>
    </div>

    <!-- è§’è‰²åˆ›å»ºå¼¹çª— -->
    <div id="character-creation-modal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="character-creation-close">&times;</span>
            <div class="creation-container">
                <h2>åˆ›å»ºè§’è‰²</h2>
                <div class="creation-form">
                    <div class="form-group">
                        <label>å§“åï¼š</label>
                        <input type="text" id="player-name" placeholder="è¯·è¾“å…¥ä½ çš„åå­—" maxlength="10">
                    </div>
                    <div class="form-group">
                        <label>ä¸“ä¸šï¼š</label>
                        <select id="player-major">
                            <option value="æ–‡å­¦">ä¸­æ–‡ç³»</option>
                            <option value="å¿ƒç†å­¦">å¿ƒç†å­¦ç³»</option>
                            <option value="è‰ºæœ¯è®¾è®¡">è‰ºæœ¯è®¾è®¡ç³»</option>
                            <option value="å¤–è¯­">å¤–è¯­ç³»</option>
                            <option value="ç»æµç®¡ç†">ç»æµç®¡ç†ç³»</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>æ€§æ ¼ï¼š</label>
                        <div class="personality-options">
                            <label><input type="radio" name="personality" value="å¼€æœ—"> å¼€æœ—</label>
                            <label><input type="radio" name="personality" value="å†…å‘"> å†…å‘</label>
                            <label><input type="radio" name="personality" value="ç†æ€§"> ç†æ€§</label>
                            <label><input type="radio" name="personality" value="æ„Ÿæ€§"> æ„Ÿæ€§</label>
                        </div>
                    </div>
                    <button id="create-character-btn">ç¡®è®¤åˆ›å»º</button>
                </div>
            </div>
        </div>
    </div>

    <!-- è¯»å–å­˜æ¡£å¼¹çª— -->
    <div id="load-game-modal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="load-game-modal-close">&times;</span>
            <h2>è¯»å–å­˜æ¡£</h2>
            <div id="save-slots">
                <!-- å­˜æ¡£æ§½ä½å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <!-- æˆå°±ç³»ç»Ÿå¼¹çª— -->
    <div id="achievements-modal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="achievements-modal-close">&times;</span>
            <h2>æˆå°±ç³»ç»Ÿ</h2>
            <div id="achievements-list">
                <!-- æˆå°±åˆ—è¡¨å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <!-- åœºæ™¯äº’åŠ¨å¼¹çª— -->
    <div id="scenario-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="scenario-title">åœºæ™¯æ ‡é¢˜</h2>
                <span class="modal-close" id="scenario-modal-close">&times;</span>
            </div>
            <div class="modal-body">
                <p class="scenario-description">åœºæ™¯æè¿°å†…å®¹...</p>
                <div class="scenario-choices">
                    <!-- é€‰æ‹©æŒ‰é’®å°†åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>
    </div>

    <!-- å›å¿†ç›¸å†Œå¼¹çª— -->
    <div id="gallery-modal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="gallery-modal-close">&times;</span>
            <h2>å›å¿†ç›¸å†Œ</h2>
            <div id="gallery-content">
                <!-- ç›¸å†Œå†…å®¹å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <!-- è®¾ç½®å¼¹çª— -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="settings-modal-close">&times;</span>
            <h2>æ¸¸æˆè®¾ç½®</h2>
            <div class="settings-container">
                <div class="setting-item">
                    <label>éŸ³æ•ˆéŸ³é‡ï¼š</label>
                    <input type="range" id="sound-volume" min="0" max="100" value="50">
                </div>
                <div class="setting-item">
                    <label>éŸ³ä¹éŸ³é‡ï¼š</label>
                    <input type="range" id="music-volume" min="0" max="100" value="50">
                </div>
                <div class="setting-item">
                    <label>è‡ªåŠ¨ä¿å­˜ï¼š</label>
                    <input type="checkbox" id="auto-save" checked>
                </div>
                <div class="setting-item">
                    <button id="reset-game-btn" style="background: #f44336;">é‡ç½®æ¸¸æˆæ•°æ®</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ç»“å±€å±•ç¤ºå¼¹çª— -->
    <div id="ending-modal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="ending-modal-close">&times;</span>
            <div id="ending-content">
                <!-- ç»“å±€å†…å®¹å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <!-- è§’è‰²é€‰æ‹©å¼¹çª— -->
    <div id="character-selection-modal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="character-selection-modal-close">&times;</span>
            <h2>é€‰æ‹©è§’è‰²</h2>
            <div id="character-selection">
                <!-- è§’è‰²é€‰æ‹©å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <!-- æ‰‹æœºç«¯è®¾ç½®å¼¹çª— -->
    <div id="mobile-settings-modal" class="mobile-settings-modal">
        <div class="mobile-settings-content">
            <h3 class="mobile-settings-title">æ¸¸æˆèœå•</h3>
            <div class="mobile-settings-buttons">
                <button class="mobile-settings-btn-item btn-save" id="mobile-save-btn">
                    ğŸ’¾ ä¿å­˜æ¸¸æˆ
                </button>
                <button class="mobile-settings-btn-item btn-settings" id="mobile-settings-modal-btn">
                    âš™ï¸ æ¸¸æˆè®¾ç½®
                </button>
                <button class="mobile-settings-btn-item btn-next" id="mobile-next-week-btn" style="display: none;">
                    â­ï¸ ä¸‹ä¸€å‘¨
                </button>
                <button class="mobile-settings-btn-item btn-menu" id="mobile-menu-btn">
                    ğŸ  è¿”å›ä¸»èœå•
                </button>
                <button class="mobile-settings-btn-item" id="mobile-close-btn" style="background: #6c757d; color: white;">
                    âŒ å…³é—­èœå•
                </button>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥æ–°çš„æ¨¡å—åŒ–æ¸¸æˆæ–‡ä»¶ -->
    <script src="assets/js/data/GameData.js"></script>
    <script src="assets/js/core/GameEngine.js"></script>
    <script src="assets/js/core/GameLogic.js"></script>
    <script src="assets/js/core/StoryManager.js"></script>
    <script src="assets/js/LoveDiaryGame.js"></script>
    
    <!-- æ‰‹æœºç«¯UIæ§åˆ¶è„šæœ¬ -->
    <script>
        // æ‰‹æœºç«¯è®¾ç½®å¼¹çª—æ§åˆ¶
        function toggleMobileSettings() {
            const modal = document.getElementById('mobile-settings-modal');
            if (modal.classList.contains('active')) {
                closeMobileSettings();
            } else {
                openMobileSettings();
            }
        }
        
        function openMobileSettings() {
            const modal = document.getElementById('mobile-settings-modal');
            modal.classList.add('active');
            
            // æ£€æŸ¥æ˜¯å¦éœ€è¦æ˜¾ç¤ºä¸‹ä¸€å‘¨æŒ‰é’®
            if (window.game && window.game.logic.gameState.actionPoints <= 0) {
                document.getElementById('mobile-next-week-btn').style.display = 'block';
            }
        }
        
        function closeMobileSettings() {
            const modal = document.getElementById('mobile-settings-modal');
            modal.classList.remove('active');
        }
        
        // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­
        document.getElementById('mobile-settings-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeMobileSettings();
            }
        });
    </script>
    
    <!-- åˆå§‹åŒ–æ¸¸æˆ -->
    <script>
        // å…¨å±€æ¸¸æˆå®ä¾‹
        let game;
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–æ¸¸æˆ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ–æ¸¸æˆ...');
            
            try {
                // åˆ›å»ºæ¸¸æˆå®ä¾‹
                game = new LoveDiaryGame();
                
                // åˆå§‹åŒ–æ¸¸æˆ
                game.init();
                
                console.log('æ¸¸æˆåˆå§‹åŒ–æˆåŠŸ');
                
            } catch (error) {
                console.error('æ¸¸æˆåˆå§‹åŒ–å¤±è´¥:', error);
                alert('æ¸¸æˆåˆå§‹åŒ–å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•ã€‚');
            }
        });
        
        // è°ƒè¯•åŠŸèƒ½
        window.debugGame = function() {
            console.log('=== æ¸¸æˆè°ƒè¯•ä¿¡æ¯ ===');
            console.log('æ¸¸æˆå®ä¾‹:', game);
            console.log('æ¸¸æˆçŠ¶æ€:', game?.logic?.gameState);
            console.log('å¼•æ“çŠ¶æ€:', game?.engine);
            console.log('GameData:', typeof GameData !== 'undefined' ? 'OK' : 'MISSING');
            console.log('==================');
        };
        
        // å¿«é€Ÿæµ‹è¯•å‡½æ•°
        window.quickStart = function() {
            if (!game) {
                alert('æ¸¸æˆæœªåˆå§‹åŒ–ï¼');
                return;
            }
            
            const testPlayer = {
                name: "æµ‹è¯•ç©å®¶",
                major: "è®¡ç®—æœºç§‘å­¦", 
                personality: "å¼€æœ—"
            };
            
            game.logic.startGame(testPlayer);
            console.log('å¿«é€Ÿå¼€å§‹æµ‹è¯•æ¸¸æˆ');
        };
        
        // è§’è‰²åˆ›å»ºæµ‹è¯•å‡½æ•°
        window.testCharacterCreation = function() {
            if (!game) {
                console.error('æ¸¸æˆæœªåˆå§‹åŒ–ï¼');
                return;
            }
            
            console.log('=== æµ‹è¯•è§’è‰²åˆ›å»ºåŠŸèƒ½ ===');
            
            // æ£€æŸ¥æ¨¡æ€æ¡†æ˜¯å¦å­˜åœ¨
            const modal = document.getElementById('character-creation-modal');
            console.log('è§’è‰²åˆ›å»ºæ¨¡æ€æ¡†:', modal ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨');
            
            // æ£€æŸ¥è¡¨å•å…ƒç´ 
            const nameInput = document.querySelector('#player-name');
            const majorSelect = document.querySelector('#player-major');
            const personalityRadios = document.querySelectorAll('input[name="personality"]');
            
            console.log('å§“åè¾“å…¥æ¡†:', nameInput ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨');
            console.log('ä¸“ä¸šé€‰æ‹©å™¨:', majorSelect ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨');
            console.log('æ€§æ ¼é€‰é¡¹æ•°é‡:', personalityRadios.length);
            
            // å°è¯•æ‰“å¼€è§’è‰²åˆ›å»ºæ¨¡æ€æ¡†
            try {
                game.showCharacterCreation();
                console.log('âœ“ è§’è‰²åˆ›å»ºæ¨¡æ€æ¡†æ‰“å¼€æˆåŠŸ');
            } catch (error) {
                console.error('âœ— æ‰“å¼€è§’è‰²åˆ›å»ºæ¨¡æ€æ¡†å¤±è´¥:', error);
            }
            
            console.log('=========================');
        };
    </script>
</body>
</html>
